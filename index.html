<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokedex</title>

    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./fonts.css">

    <script>
        let currentPokemonName = 'charmander';
        let currentPokemon;
        let currentPokemonSpecies;
        let currentPokemonEvolution;
        

        async function loadPokemon() {
            let url = `https://pokeapi.co/api/v2/pokemon/${currentPokemonName}`;
            let response = await fetch(url);
            currentPokemon = await response.json();
            await loadPokemonSpecies();
            await loadPokemonEvolution();

            showDetailsPokemon();
        }

        async function loadPokemonSpecies() {
            let url = `${currentPokemon['species']['url']}`;
            let response = await fetch(url);
            currentPokemonSpecies = await response.json();
        }

        async function loadPokemonEvolution() {
            let url = `${currentPokemonSpecies['evolution_chain']['url']}`;
            let response = await fetch(url);
            currentPokemonEvolution = await response.json();
        }


        function showDetailsPokemon() {
            let pokemonName = document.getElementById('pokemon-name');
            pokemonName.innerHTML = `${charToUpperCase(currentPokemon['forms'][0]['name'])}`;

            let pokemonID = document.getElementById('pokemon-id');
            pokemonID.innerHTML = `#${pokemonIDFillWithZeros()}`

            let pokemonType = document.getElementById('pokemon-type');
            pokemonType.innerHTML = `${charToUpperCase(currentPokemon['types'][0]['type']['name'])}`;

            let pokemonSprite = document.getElementById('pokemon-sprite')
            pokemonSprite.src = `${currentPokemon['sprites']['other']['official-artwork']['front_default']}`;
            //show standard about stats
            loadAbout();
        }


        function charToUpperCase(text) {
            let firstCharUpperCase = text.charAt(0).toUpperCase() + text.slice(1);
            return firstCharUpperCase;
        }


        function pokemonIDFillWithZeros() {
            if (currentPokemon['id'] > 99) {
                return (currentPokemon['id'] + "").padStart(1, "0");

            } else if (currentPokemon['id'] > 9) {
                return (currentPokemon['id'] + "").padStart(2, "0");

            } else {
                return (currentPokemon['id'] + "").padStart(3, "0");
            }
        }


        function unloadAllStats(){
            document.getElementById('pokemon-details-about').classList.add('d-none');
            document.getElementById('pokemon-details-basestats').classList.add('d-none');
            document.getElementById('pokemon-details-evolution').classList.add('d-none');
            document.getElementById('pokemon-details-moves').classList.add('d-none');
        }


        function loadBaseStats(){
            buttonStyleDeAct();
            buttonStyleAct('stats-button1');
            unloadAllStats();
            showPokemonStats();
            document.getElementById('pokemon-details-basestats').classList.remove('d-none');
        }

        function showPokemonStats(){
            let totalStatPoints = 0;
            for (let i = 0; i < currentPokemon['stats'].length; i++) {
                let pokemonStat = document.getElementById(`pokemon-stat${i}`);
                pokemonStat.innerHTML = `${currentPokemon['stats'][i]['base_stat']}`
                totalStatPoints += currentPokemon['stats'][i]['base_stat'];
                showPokemonStatsPb(i);
                showPokemonStatsTypeAnimation(i);
            }
            let pokemonStatTotal = document.getElementById('pokemon-stat-total');

            pokemonStatTotal.innerHTML = `${totalStatPoints}`;
             
            document.getElementById(`type-gif-total`).innerHTML += `<div class="type-gif"><img style="left:calc(${totalStatPoints/10}% - 9px)" src="./img/fire.gif" alt=""></div>`;
            showPokemonTotalStatsPb(totalStatPoints);
        }

        function showPokemonStatsPb(i){
            PokemonStatPb = document.getElementById(`pokemon-stat${i}-pb`);
            PokemonStatPb.value = `${currentPokemon['stats'][i]['base_stat']}`;
            PokemonStatPb.max = 100;
            
        }

        function showPokemonTotalStatsPb(totalStatPoints){
            pokemonTotalStatPb = document.getElementById(`pokemon-stat-total-pb`);
            pokemonTotalStatPb.value = `${totalStatPoints}`;
            pokemonTotalStatPb.max = 1000;
            
        }

        function showPokemonStatsTypeAnimation(i){
            document.getElementById(`type-gif${i}`).innerHTML += `<div class="type-gif"><img style="left:calc(${currentPokemon['stats'][i]['base_stat']}% - 9px)" src="./img/fire.gif" alt=""></div>`;
        }


        function loadEvolution(){
            buttonStyleDeAct();
            buttonStyleAct('stats-button2');
            unloadAllStats();
        }


        function loadMoves(){
            buttonStyleDeAct();
            buttonStyleAct('stats-button3');
            unloadAllStats();
        }

        
    </script>
</head>

<body onload="loadPokemon()">
    <section class="pokemon-details">
        <div class="bg-details">
            <div class="global-info">
                <img class="arrow-back" src="./img/arrow_down.ico" alt="">
                <h1 id="pokemon-name"></h1>
                <span class="pokemon-id" id="pokemon-id"></span>
                <span class="pokemon-type" id="pokemon-type"></span>
            </div>
        </div>
        <div class="bg-details-chart">
            <div class="pokemon-sprite">
                <img id="pokemon-sprite" alt="picture of pokemon">
            </div>
            <nav class="pokemon-details-nav">
                <button onclick="loadAbout()" id="stats-button0">About</button>
                <button onclick="loadBaseStats()" id="stats-button1">Base Stats</button>
                <button onclick="loadEvolution()" id="stats-button2">Evolution</button>
                <button onclick="loadMoves()" id="stats-button3">Moves</button>
            </nav>
            <div class="buttons-underline"></div>
            <div id="pokemon-details-content" class="pokemon-details-content">
                <!-- About -->
                <div id="pokemon-details-about" class="pokemon-details-about">
                    <table>
                        <tr>
                            <td>Species</td>
                            <td id="pokemon-species" class="pokemon-species"></td>
                        </tr>

                        <tr>
                            <td>Height</td>
                            <td id="pokemon-height" class="pokemon-height"></td>
                        </tr>

                        <tr>
                            <td>Weight</td>
                            <td id="pokemon-weight" class="pokemon-weight"></td>
                        </tr>

                        <tr>
                            <td>Abilities</td>
                            <td id="pokemon-abilities" class="pokemon-abilities"></td>
                        </tr>
                        <tr>
                            <td>
                                <h3>Breeding</h3>
                            </td>
                        </tr>
                        <tr>
                            <td>Gender</td>
                            <td id="pokemon-gender" class="pokemon-gender"></td>
                        </tr>

                        <tr>
                            <td>Egg Groups</td>
                            <td id="pokemon-egg-groups" class="pokemon-egg-groups"></td>
                        </tr>

                        <tr>
                            <td>Egg Cycle</td>
                            <td id="pokemon-egg-cycle" class="pokemon-egg-cycle"></td>
                        </tr>
                    </table>
                </div>

                <!-- Base Stats -->
                <div id="pokemon-details-basestats" class="pokemon-details-basestats d-none">
                    <table >
                        <tr>
                            <td>HP</td>
                            <td id="pokemon-stat0" class="pokemon-hp"></td>
                            <td id="type-gif0"><progress id="pokemon-stat0-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Attack</td>
                            <td id="pokemon-stat1" class="pokemon-attack"></td>
                            <td id="type-gif1"><progress id="pokemon-stat1-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Defence</td>
                            <td id="pokemon-stat2" class="pokemon-defense"></td>
                            <td id="type-gif2"><progress id="pokemon-stat2-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Sp. Atk</td>
                            <td id="pokemon-stat3" class="pokemon-spatk"></td>
                            <td id="type-gif3"><progress id="pokemon-stat3-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Sp. Def</td>
                            <td id="pokemon-stat4" class="pokemon-spdef"></td>
                            <td id="type-gif4"><progress id="pokemon-stat4-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Speed</td>
                            <td id="pokemon-stat5" class="pokemon-speed"></td>
                            <td id="type-gif5"><progress id="pokemon-stat5-pb" class="stats-progressbar"></progress></td>
                        </tr>

                        <tr>
                            <td>Total</td>
                            <td id="pokemon-stat-total" class="pokemon-total"></td>
                            <td id="type-gif-total"><progress id="pokemon-stat-total-pb" class="stats-progressbar"></progress></td>
                        </tr>
                        
                    </table>
                    <h3>Type defenses</h3>
                    <span class="text-defenses">??? effectiveness ???</span>
                </div>

                <!-- Evolution -->
                <div id="pokemon-details-evolution" class="pokemon-details-evolution d-none">
                    <!-- <table >
                        <tr>
                            <td>HP</td>
                            <td id="pokemon-hp" class="pokemon-hp"></td>
                            <td id="pokemon-hp-pb" class="pokemon-hp-pb"></td>
                        </tr>

                        <tr>
                            <td>Attack</td>
                            <td id="pokemon-attack" class="pokemon-attack"></td>
                            <td id="pokemon-attack-pb" class="pokemon-attack-pb"></td>
                        </tr>

                        <tr>
                            <td>Defence</td>
                            <td id="pokemon-defense" class="pokemon-defense"></td>
                            <td id="pokemon-defense-pb" class="pokemon-defense-pb"></td>
                        </tr>

                        <tr>
                            <td>Sp. Atk</td>
                            <td id="pokemon-spatk" class="pokemon-spatk"></td>
                            <td id="pokemon-spatk-pb" class="pokemon-spatk-pb"></td>
                        </tr>

                        <tr>
                            <td>Sp. Def</td>
                            <td id="pokemon-spdef" class="pokemon-spdef"></td>
                            <td id="pokemon-spdef-pb" class="pokemon-spdef-pb"></td>
                        </tr>

                        <tr>
                            <td>Speed</td>
                            <td id="pokemon-speed" class="pokemon-speed"></td>
                            <td id="pokemon-speed-pb" class="pokemon-speed-pb"></td>
                        </tr>

                        <tr>
                            <td>Total</td>
                            <td id="pokemon-total" class="pokemon-total"></td>
                            <td id="pokemon-total-pb" class="pokemon-total-pb"></td>
                        </tr>

                    </table> -->
                    <h3>Type defenses</h3>
                    <span class="text-defenses">??? effectiveness ???</span>
                </div>

                <!-- Moves -->
                <div id="pokemon-details-moves" class="pokemon-details-moves d-none">
                    <!-- <table >
                        <tr>
                            <td>HP</td>
                            <td id="pokemon-hp" class="pokemon-hp"></td>
                            <td id="pokemon-hp-pb" class="pokemon-hp-pb"></td>
                        </tr>

                        <tr>
                            <td>Attack</td>
                            <td id="pokemon-attack" class="pokemon-attack"></td>
                            <td id="pokemon-attack-pb" class="pokemon-attack-pb"></td>
                        </tr>

                        <tr>
                            <td>Defence</td>
                            <td id="pokemon-defense" class="pokemon-defense"></td>
                            <td id="pokemon-defense-pb" class="pokemon-defense-pb"></td>
                        </tr>

                        <tr>
                            <td>Sp. Atk</td>
                            <td id="pokemon-spatk" class="pokemon-spatk"></td>
                            <td id="pokemon-spatk-pb" class="pokemon-spatk-pb"></td>
                        </tr>

                        <tr>
                            <td>Sp. Def</td>
                            <td id="pokemon-spdef" class="pokemon-spdef"></td>
                            <td id="pokemon-spdef-pb" class="pokemon-spdef-pb"></td>
                        </tr>

                        <tr>
                            <td>Speed</td>
                            <td id="pokemon-speed" class="pokemon-speed"></td>
                            <td id="pokemon-speed-pb" class="pokemon-speed-pb"></td>
                        </tr>

                        <tr>
                            <td>Total</td>
                            <td id="pokemon-total" class="pokemon-total"></td>
                            <td id="pokemon-total-pb" class="pokemon-total-pb"></td>
                        </tr>

                    </table> -->
                    <h3>Type defenses</h3>
                    <span class="text-defenses">??? effectiveness ???</span>
                </div>

            </div>

        </div>
    </section>

    <!--------------- Load Script Templates -------------------->
    <script src="./templates/poke-about.js"></script>

</body>

</html>